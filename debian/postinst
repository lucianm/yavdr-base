#!/bin/bash -e

case "$1" in
  configure)

  # conffiles
  . /usr/share/yavdr/helpers/conffiles
  install_conffile yavdr-base /etc/acpi/powerbtn.sh
  install_conffile yavdr-base /etc/default/grub
  install_conffile yavdr-base /etc/logrotate.conf
  install_conffile yavdr-base /etc/update-manager/release-upgrades

  # prefill hdf
  . /usr/share/yavdr/helpers/hdf_prefill

  hdf_prefill "system.grub.options" "vmalloc=256m nohz=off acpi_enforce_resources=lax"
  hdf_prefill "system.shutdown" "s3"
  hdf_prefill "system.wakeup.method" "acpi"
  hdf_prefill "system.wakeup.disable_usb" "1"
  hdf_prefill "system.sleep.module" "uswsusp"
  hdf_prefill "system.sleep.options" "-f"

  # temlate files
  /usr/bin/yavdr-template-base

  # update grub
  /usr/sbin/update-grub

  # bash hack
  ln -sf /bin/bash /bin/sh

  ;;

esac

exit 0
